<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">

  <meta name="description" content="An app store for open source apps, developed and maintained by Double Dot Labs.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="generator" content="DDStore" />
	<title>DDStore</title>

	<meta name="theme-color" content="#FFFFFF">
  <meta name="mobile-web-app-capable" content="yes">
  <!-- <link rel="manifest" href="manifest.json"> -->

  <meta name="application-name" content="DDStore">
  <meta name="msapplication-TileColor" content="#FFFFFF">
  <meta name="msapplication-tooltip" content="DDStore">
  <!-- <meta name="msapplication-config" content="/ieconfig.xml"> -->

	<!-- <link rel="shortcut icon" href="/favicon.ico">
  <link rel="icon" sizes="16x16" href="/favicon.ico">
  <link rel="icon" sizes="24x24" href="/images/favicon-24.ico">
  <link rel="icon" sizes="32x32" href="/images/favicon-32.ico">
  <link rel="icon" sizes="48x48" href="/images/favicon-48.ico">
  <link rel="icon" sizes="64x64" href="/images/favicon-48.ico"> -->

	<meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="white">
  <meta name="apple-mobile-web-app-title" content="DDStore">
  <!-- <link rel="apple-touch-icon-precomposed" href="/images/favicon-152.png"> -->

	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">

	<style>
		#logo {
			position: absolute;
			top: 50%;
			transform: translateY(-50%);
			white-space: nowrap;
			cursor: pointer;
		}

		#logo>* {
			font-weight: bolder;
			font-size: 1.75em;
			margin: 0;
			display: inline-block;
			margin-right: 0.5em;
		}

		#logo>img {
			height: 1.5em;
		}

		#logo>h1 {
			position: absolute;
		}

		#signin, #profile {
			position: absolute;
			padding: 0.4em 0.8em;
			top: 50%;
			right: 1.5em;
			cursor: pointer;
			transform: translateY(-50%);

			-moz-transition: background-color .25s;
			-o-transition: background-color .25s;
			-webkit-transition: background-color .25s;
			transition: background-color .25s;
		}

		#search {
			display: none;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: 50%;
			border: none;
			background-color: rgba(0, 0, 0, 0.075);
			padding: 1em 1.4em;
			border-radius: 0.4em;
		}

		#search::placeholder {
			color: rgba(0, 0, 0, 0.5);
			font-weight: bold;
		}

		@media(min-width: 900px) {
			#search {
				display: block;
			}
		}
	</style>
</head>
<body>
	<header>
		<div id="logo" onclick="setPage('home');"><img src="https://doubledotlabs.github.io/images/logo.svg"><h1>Store</h1></div>
		<input id="search" type="text" placeholder="Search for Apps..."></input>
		<button id="signin" class="outline">
			SIGN IN
		</button>
		<span id="profile" style="display: none;">
			<span id="profileName"></span>
			<img id="profilePicture">
		</span>
	</header>
	<main id="main"></main>

	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>

	<script type="text/javascript" src="js/testdata.js"></script>
	<script type="text/javascript" src="js/methods.js"></script>
	<script type="text/javascript" src="js/content.js"></script>
	<script>
		var main = document.getElementById("main");

		function getPage() {
    	if (window.location.search)
      	return window.location.search.replace("?", "");
    	else return "home";
  	}

		function setPage(page, replace) {
			document.body.style.background = null;
			main.style.background = null;

			if (page == "home") {
				page = null;
				clearElement(main);
				main.appendChild(createElement(carouselListMethod({
					autoplay: true,
  				centerMode: true,
  				centerPadding: '80px',
  				slidesToShow: 4,
					dots: true,
					arrows: false,
  				infinite: true,
  				responsive: [
						{
      				breakpoint: 1600,
      				settings: {
        				centerMode: true,
        				centerPadding: '60px',
        				slidesToShow: 3
      				}
    				},
    				{
      				breakpoint: 900,
      				settings: {
        				centerMode: true,
        				centerPadding: '40px',
        				slidesToShow: 2
      				}
    				},
    				{
      				breakpoint: 600,
      				settings: {
        				centerMode: true,
        				centerPadding: '0px',
        				slidesToShow: 1
      				}
    				}
  				]
				}, apps, largeCardsMethod)));
				getCategories(main, rowListMethod, smallCardsMethod);
			} else if (page.startsWith("app=")) {
				clearElement(main);
				var app = getApp(page.substring(4));
				if (app) {
					document.body.style.background = "url(\"" + app.header + "\") 100% 100% / 9999% 9999% no-repeat fixed";
					main.style.background = "#FFF";
					main.appendChild(createElement("<div class=\"header\" style=\"background: url(\'" + app.header + "\') center / cover no-repeat;\"></div>"));
					main.appendChild(createElement("<div class=\"appinfo\"><div class=\"appiconinfo\"><img class=\"appicon\" src=\"" + app.icon + "\"><button class=\"outline\">DOWNLOAD</button></div>"
					  + "<div class=\"appnameinfo\"><h1 class=\"appname\">" + app.name + "</h1><p>" + app.summary + "</p></div></div>"));

					main.appendChild(createElement(carouselListMethod({
						autoplay: true,
	  				slidesToShow: 4,
						dots: app.screenshots.length > 4,
						arrows: false,
						variableWidth: true,
						infinite: false,
	  				responsive: [
							{
	      				breakpoint: 1600,
	      				settings: {
									dots: app.screenshots.length > 3,
	        				slidesToShow: 3
	      				}
	    				},
	    				{
	      				breakpoint: 900,
	      				settings: {
									dots: app.screenshots.length > 2,
	        				slidesToShow: 2
	      				}
	    				},
	    				{
	      				breakpoint: 600,
	      				settings: {
									dots: app.screenshots.length > 1,
	        				slidesToShow: 1
	      				}
	    				}
	  				]
					}, app.screenshots, imageCardsMethod)));

					main.appendChild(createElement("<div class=\"appdesc\"><p>" + app.description + "</p><a>READ MORE</a></div>"));
					main.appendChild(createElement(overflowListMethod({}, app.categories, chipsMethod)));
					main.appendChild(createElement(gridListMethod({"name": "Reviews"}, app.reviews, reviewMethod)));
					main.appendChild(createElement(rowListMethod({
						"name": "Related<br>Apps",
						"id": "similar/" + app.package,
						"color": "#000",
						"background": "#F5F5F5"
					}, apps, smallCardsMethod)));
				} else {
					setPage("404");
					return;
				}
			} else if (page.startsWith("category=")) {
				clearElement(main);
				var category = getCategory(page.substring(9));
				if (category) {
					document.body.style.background = category.background ? category.background : "inherit";
					main.appendChild(createElement(overflowListMethod(category, apps, tinyCardsMethod)));
				} else {
					setPage("404");
					return;
				}
			} else {
				page = "404";
				clearElement(main);
				main.appendChild(createElement("<div class=\"indented\"><h1>Error 404</h1><p>Sorry, we couldn\'t find what you\'re looking for.</p><button class=\"outline\" onclick=\"window.history.back();\">GO BACK</button></div>"));
			}

		  if (replace)
				window.history.replaceState(null, null, page ? "?" + page : "?");
			else window.history.pushState("", "", page ? "?" + page : "?");
			window.scrollTo(0, 0);
			$(".carousel").slick();
		}

		function clearElement(element) {
			while (element.firstChild) {
				element.removeChild(element.firstChild);
			}
		}

		setPage(getPage(), true);

		window.onpopstate = function() {
			setPage(getPage(), true);
		}
	</script>
</body>
</html>

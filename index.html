<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">

  <meta name="description" content="An app store for open source apps, developed and maintained by Double Dot Labs.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="generator" content="DDStore" />
	<title>DDStore</title>

	<meta name="theme-color" content="#FFFFFF">
  <meta name="mobile-web-app-capable" content="yes">
  <!-- <link rel="manifest" href="manifest.json"> -->

  <meta name="application-name" content="DDStore">
  <meta name="msapplication-TileColor" content="#FFFFFF">
  <meta name="msapplication-tooltip" content="DDStore">
  <!-- <meta name="msapplication-config" content="/ieconfig.xml"> -->

	<!-- <link rel="shortcut icon" href="/favicon.ico">
  <link rel="icon" sizes="16x16" href="/favicon.ico">
  <link rel="icon" sizes="24x24" href="/images/favicon-24.ico">
  <link rel="icon" sizes="32x32" href="/images/favicon-32.ico">
  <link rel="icon" sizes="48x48" href="/images/favicon-48.ico">
  <link rel="icon" sizes="64x64" href="/images/favicon-48.ico"> -->

	<meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="white">
  <meta name="apple-mobile-web-app-title" content="DDStore">
  <!-- <link rel="apple-touch-icon-precomposed" href="/images/favicon-152.png"> -->

	<!-- firebase stuff -->
	<script src="https://www.gstatic.com/firebasejs/4.7.0/firebase.js"></script>
	<script>
  	var config = {
    	apiKey: "AIzaSyD4i89pKORT3k0z60zgMB5O7VIDG12BwzE",
    	authDomain: "ddstore-87442.firebaseapp.com",
    	databaseURL: "https://ddstore-87442.firebaseio.com",
    	projectId: "ddstore-87442",
    	storageBucket: "ddstore-87442.appspot.com",
    	messagingSenderId: "292878095265"
  	};
  	firebase.initializeApp(config);
	</script>
	<script src="https://cdn.firebase.com/libs/firebaseui/2.5.1/firebaseui.js"></script>
	<link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/2.5.1/firebaseui.css" />

	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">

	<style>
		#logo {
			position: absolute;
			top: 50%;
			transform: translateY(-50%);
			white-space: nowrap;
			cursor: pointer;
			user-select: none;
		}

		#logo>* {
			font-weight: bolder;
			font-size: 1.75em;
			margin: 0;
			display: inline-block;
			margin-right: 0.5em;
		}

		#logo>img {
			height: 1.5em;
		}

		#logo>h1 {
			position: absolute;
		}

		#signin, #profile {
			display: block;
			position: absolute;
			padding: 0.4em 0.8em;
			top: 50%;
			right: 1.5em;
			cursor: pointer;
			transform: translateY(-50%);

			-moz-transition: background-color .25s;
			-o-transition: background-color .25s;
			-webkit-transition: background-color .25s;
			transition: background-color .25s;
		}

		#profile {
			display: flex;
			align-items: center;
		}

		#profilePicture {
			width: 3em;
			height: 3em;
			border-radius: 1.5em;
			border: 1px solid #000;
		}

		#profileName {
			margin-right: 1em;
			font-size: 1.2em;
		}

		#profileEmail {
			font-size: 0.9em;
		}

		#search {
			display: none;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: 50%;
			border: none;
			background-color: rgba(0, 0, 0, 0.075);
			padding: 1em 1.4em;
			border-radius: 0.4em;
		}

		#search::placeholder {
			color: rgba(0, 0, 0, 0.5);
			font-weight: bold;
		}

		@media(min-width: 900px) {
			#search {
				display: block;
			}
		}
	</style>
</head>
<body>
	<header>
		<div id="logo" onclick="setPage('page=home');"><img src="https://doubledotlabs.github.io/images/logo.svg"><h1>Store</h1></div>
		<input id="search" type="text" placeholder="Search for Apps...">
		<button id="signin" class="outline" onclick="setPage('page=signin');">
			SIGN IN
		</button>
		<span id="profile" style="display: none;">
			<div style="margin-right: 1em;">
				<span id="profileName"></span><br>
				<span id="profileEmail"></span>
			</div>
			<img id="profilePicture">
		</span>
	</header>
	<main id="main"></main>

	<!-- jquery -->
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>

	<!-- slick -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>

	<script type="text/javascript" src="js/testdata.js"></script>
	<script type="text/javascript" src="js/utils.js"></script>
	<script type="text/javascript" src="js/methods.js"></script>
	<script type="text/javascript" src="js/content.js"></script>
	<script>
		var main = document.getElementById("main");
		var signInElement = document.getElementById("signin");
		var profileElement = document.getElementById("profile");
		var profileNameElement = document.getElementById("profileName");
		var profileEmailElement = document.getElementById("profileEmail");
		var profilePictureElement = document.getElementById("profilePicture");

		function getPage() {
    	if (window.location.search)
      	return window.location.search.replace("?", "");
    	else return "home";
  	}

		function setPage(page, replace) {
			document.body.style.background = null;
			main.style.background = null;
			var shouldScrollTop = true;

			var args = page;
			if (typeof page == "string") {
				args = stringToArguments(page);
			} else page = argumentsToString(args);

			if (!args.page) {
				args.page = "home";
				page = "?";
			}

			if (args.page == "home") {
				page = null;
				clearElement(main);

				getCategory("featured", function(category) {
					main.appendChild(createElement(carouselListMethod({
						autoplay: true,
	  				centerMode: true,
	  				centerPadding: '80px',
	  				slidesToShow: 4,
						dots: true,
						arrows: false,
	  				infinite: true,
	  				responsive: [
							{
	      				breakpoint: 1600,
	      				settings: {
	        				centerMode: true,
	        				centerPadding: '60px',
	        				slidesToShow: 3
	      				}
	    				},
	    				{
	      				breakpoint: 900,
	      				settings: {
	        				centerMode: true,
	        				centerPadding: '40px',
	        				slidesToShow: 2
	      				}
	    				},
	    				{
	      				breakpoint: 600,
	      				settings: {
	        				centerMode: true,
	        				centerPadding: '0px',
	        				slidesToShow: 1
	      				}
	    				}
	  				]
					}, category.apps.slice(0, 6), largeCardsMethod)));
				});

				getCategories(function(categories) {
					for (var i = 0; i < categories.length; i++) {
						main.appendChild(createElement(rowListMethod(categories[i], categories[i].apps, smallCardsMethod)));
					}
				});
			} else if (args.page == "app") {
				clearElement(main);

				getApp(args.package, function(app) {
					document.body.style.background = "url(\"" + app.header + "\") 100% 100% / 9999% 9999% no-repeat fixed";
					main.style.background = "#FFF";
					main.appendChild(createElement("<div class=\"header\" style=\"background: url(\'" + app.header + "\') center / cover no-repeat;\"></div>"));
					main.appendChild(createElement("<div class=\"appinfo\"><div class=\"appiconinfo\"><img class=\"appicon\" src=\"" + app.icon + "\"><button class=\"outline\" onclick=\"setPage(\'page=reviews&package=" + app.package + "&write\')\">RATE / REVIEW</button></div>"
						+ "<div class=\"appnameinfo\"><h1>" + app.name + "</h1><h3><a onclick=\"setPage(\'page=user&id=" + app.author.id + "\');\">" + app.author.name + "</a></h3><p>" + app.summary + "</p>"
						+ overflowListMethod({}, app.links, linksMethod) + "</div></div>"));

					appendAppDownloadSection(app, true, main, args);

					main.appendChild(createElement(carouselListMethod({
						slidesToShow: 4,
						dots: app.screenshots.length > 4,
						arrows: false,
						variableWidth: true,
						infinite: false,
						responsive: [
							{
								breakpoint: 1600,
								settings: {
									dots: app.screenshots.length > 3,
									slidesToShow: 3
								}
							},
							{
								breakpoint: 900,
								settings: {
									dots: app.screenshots.length > 2,
									slidesToShow: 2
								}
							},
							{
								breakpoint: 600,
								settings: {
									dots: app.screenshots.length > 1,
									slidesToShow: 1
								}
							}
						]
					}, app.screenshots, imageCardsMethod)));

					main.appendChild(createElement("<div class=\"appdesc\"><p>" + app.description + "</p><a>READ MORE</a></div>"));
					main.appendChild(createElement(overflowListMethod({}, app.categories, chipsMethod)));

					var downloadsColor = "#000";
					if (app.downloads > 50000)
						downloadsColor = "#3F51B5";
					else if (app.downloads > 5000)
						downloadsColor = "#15AF5E";
					else if (app.downloads > 1000)
						downloadsColor = "#2962FF";

					main.appendChild(createElement("<div class=\"row grid inner-shadow\"><div style=\"text-align: center;\"><h1 style=\"color: " + getRatingColor(app.rating) + ";\">" + app.rating + "</h1><h4>Average Rating</h4></div><div style=\"text-align: center;\"><h1 style=\"color: " + downloadsColor + ";\">" + app.downloads + "</h1><h4>Downloads</h4></div></div>"));
					main.appendChild(createElement(gridListMethod({"name": "Reviews"}, app.reviews, reviewMethod)));
					main.appendChild(createElement("<a class=\"indented\" onclick=\"setPage(\'page=reviews&package=" + app.package + "\')\"><i class=\"material-icons\">open_in_new</i>All Reviews</a><a class=\"indented\" onclick=\"setPage(\'page=reviews&package=" + app.package + "&write\');\"><i class=\"material-icons\">rate_review</i>Write a Review</a>"));
					main.appendChild(createElement("<div class=\"inner-shadow\">" + rowListMethod({
						"name": "Related<br>Apps",
						"id": "similar/" + app.package,
						"color": "#000",
						"background": "transparent",
						"shade": "#F5F5F5"
					}, apps, smallCardsMethod) + "</div>"));
				});
			} else if (args.page == "reviews") {
				if (args.write) {
					main.appendChild(createElement("<div class=\"dialog\"><div>"
						+ "<h2 style=\"margin: 0; margin-bottom: 0.5em;\">Rate / Review</h2>"
						+ "<div style=\"text-align: center;\">"
						+ "<div id=\"ratingSelect\" class=\"rating active\"><span>&#9734;</span><span>&#9734;</span><span>&#9734;</span><span>&#9734;</span><span>&#9734;</span></div>"
						+ "</div>"
						+ "<div class=\"input\" contentEditable=\"true\" placeholder=\"Write a review...\"></div>"
						+ "<small>Reviews should be between 50 and 500 characters.</small>"
						+ "<div>"
						+ "<a id=\"reviewSubmit\" style=\"float: right;\" onclick=\"window.history.back();\">SUBMIT</a>"
						+ "<a style=\"float: right; margin-right: 1em;\" onclick=\"window.history.back();\">CANCEL</a>"
						+ "</div>"
						+ "</div></div>"));

					var onRatingSelect = function(e) {
						if (e.target.className && e.target.className.indexOf("selected") >= 0) {
							e.target.className = null;
						} else {
							var ratingElement = document.getElementById("ratingSelect");
							for (var i = 0; i < ratingElement.childNodes.length; i++) {
								ratingElement.childNodes[i].className = null;
							}

							e.target.className = "selected";
						}
					};

					var ratingElement = document.getElementById("ratingSelect");
					for (var i = 0; i < ratingElement.childNodes.length; i++) {
						ratingElement.childNodes[i].addEventListener("click", onRatingSelect);
					}

					var onSubmit = function() {

					}

					shouldScrollTop = false;
				} else {
					clearElement(main);

					getReviews(args.package, function(reviews) {
						main.appendChild(createElement("<div class=\"single\">" + gridListMethod({"name": "Reviews"}, reviews, reviewMethod) + "</div>"));
						main.appendChild(createElement("<hr><a style=\"display: block; text-align: center; padding: 0.5em 0;\" onclick=\"setPage(\'page=reviews&package=" + args.package + "&write\');\"><i class=\"material-icons\">rate_review</i>Write a Review</a><br>"));
					});
				}
			} else if (args.page == "releases") {
				clearElement(main);

				main.appendChild(createElement("<div id=\"singleReleases\" class=\"single\"></div>"))

				getApp(args.package, function(app) {
					appendAppDownloadSection(app, false, document.getElementById("singleReleases"), args);
				});
			} else if (args.page == "review") {
				clearElement(main);

				getReview(args.id, function(review) {
					main.appendChild(createElement("<div class=\"single\">" + reviewMethod(review) + "</div>"));
				});
			} else if (args.page == "category") {
				clearElement(main);
				getCategory(args.id, function(category) {
					document.body.style.background = category.background ? category.background : "inherit";
					main.appendChild(createElement(overflowListMethod(category, apps, tinyCardsMethod)));
				});
			} else if (args.page == "signin") {
				clearElement(main);
				main.appendChild(createElement("<div style=\"padding: calc(5vw + 1em);\">"
					+ "<div id=\"auth-container\"></div>"
					+ "<h2>Open-Source Only</h2>"
					+ "<p>To encourage openness and prevent the spread of malware and adware through devices, our app store only contains open source projects. "
					+ "All apps are reviewed by real humans after submission, and their content is verified. Benefits to developers: free resource usage analysis "
					+ "and an extra layer of error checking! Benefits to users: less worrying about the integrity of a product and more fun using it!</p>"
					+ "<br><h2>Do No Evil</h2>"
					+ "<p>Misleading apps are a bad thing, but shutting down a project because of a misunderstanding is unnecessary and stupid. "
					+ "When an app submission results in an issue, we don't just tell the developer to go away. Instead, we strive to fix the issues we find "
					+ "and help the project achieve success.</p>"
					+ "<br><h2>Plagiarisms Beware</h2>"
					+ "<p>While it isn't possible to check the entirety of the internet for duplicate code, we do our best to prevent copied or unattributed apps "
					+ "from making their way onto our store. We keep documentation of all dependencies our apps use and what license they are published under to "
					+ "ensure that no issues occur.</p>"
					+ "<br><h2>But At What Cost?</h2>"
					+ "<p>As I'm sure you can tell, we have put a lot of work into making this project a success (pro tip: promising success before it's achieved is a "
					+ "horrible method of motivation). From the backend magic to our beautiful website "
					+ "to our Android app, this project has taken months of planning and development to complete. And it's still not over. However, because all the "
					+ "applications on here are free, we don't think it's right for their users to pay to use them or for their developers to pay to publish them. "
					+ "That's why we intend to make all our money through donations, advertisements, and paid promotions. As the project expands, we may implement our "
					+ "own method of donating to the developers of apps we host that we take a percentage of, but that will come later. Much, much later.</p>"
					+ "</div>"));

      	// Initialize the FirebaseUI Widget using Firebase.
      	var ui = new firebaseui.auth.AuthUI(firebase.auth());
      	// The start method will wait until the DOM is loaded.
      	ui.start('#auth-container', {
        	signInSuccessUrl: "javascript:setPage(\'page=home\');",
        	signInOptions: [
          	// Leave the lines as is for the providers you want to offer your users.
          	firebase.auth.GoogleAuthProvider.PROVIDER_ID,
          	firebase.auth.TwitterAuthProvider.PROVIDER_ID,
          	firebase.auth.GithubAuthProvider.PROVIDER_ID,
          	firebase.auth.EmailAuthProvider.PROVIDER_ID
        	],
        	// Terms of service url.
        	tosUrl: 'https://doubledotlabs.github.io/tos/?ddstore'
      	});
			} else if (args.page == "user") {
				clearElement(main);

				getUser(args.id, function(user) {
					main.appendChild(createElement("<div class=\"userinfo\">"
						+ "<img class=\"userimage\" src=\"" + user.image + "\">"
						+ "<span>" + user.name + "</span>"
						+ (user.links && user.links.length > 0 ? overflowListMethod({}, user.links, linksMethod) : "")
						+ "</div>"));

					if (user.apps) {
						main.appendChild(createElement("<hr>"
							+ "<h1 class=\"indented\">Apps</h1>"
						  + overflowListMethod({}, apps, tinyCardsMethod)));
					}

					if (user.reviews) {
						getReviews("", function(reviews) {
							main.appendChild(createElement("<hr>"
								+ "<h1 class=\"indented\">Reviews</h1>"
							  + gridListMethod({}, reviews, reviewMethod)));
						});
					}
				});
			} else {
				page = "page=404";
				clearElement(main);
				main.appendChild(createElement("<div class=\"indented\"><h1>Error 404</h1><p>Sorry, we couldn\'t find what you\'re looking for.</p><button class=\"outline\" onclick=\"window.history.back();\">GO BACK</button></div>"));
			}

			console.log(args);
			console.log(page);

		  if (replace)
				window.history.replaceState({}, "", page ? "?" + page : "?");
			else {
				window.history.pushState({}, "", page ? "?" + page : "?");
				if (shouldScrollTop)
					window.scrollTo(0, 0);
			}

			$(".carousel").slick();
		}

		function appendAppDownloadSection(app, shouldShorten, element, args) {
			var configurations = [];
			var sdks = [];
			var architectures = [];
			var dpis = [];

			for (var i = 0; i < app.releases.length; i++) {
				var release = app.releases[i];
				for (var i2 = 0; i2 < release.downloads.length; i2++) {
					var download = release.downloads[i2];

					var config = download.config ? download.config : "phone";
					if (configurations.indexOf(config) == -1)
						configurations.push(config);

					var sdk = null;
					if (download.max) {
						sdk = [download.min, download.max];
					} else {
						sdk = [download.min, -1];
					}

					var includesSdk = false;
					for (var i3 = 0; i < sdks.length; i++) {
						if (sdks[i3][0] < sdk[1]) {
							if (sdk[0] < sdks[i3][0])
								sdks[i3][0] = sdk[0];

							includesSdk = true;
							break;
						} else if (sdks[i3][1] > sdk[0] || sdks[i3][1] == -1) {
							if (sdk[1] > sdks[i3][1] || sdk[1] == -1)
								sdks[i3][1] = sdk[1];

							includesSdk = true;
							break;
						}
					}

					if (!includesSdk)
						sdks.push(sdk);

					var arch = download.arch ? download.arch : "all";
					if (architectures.indexOf(arch) == -1)
						architectures.push(arch);

					var dpi = null;
					if (download.minDpi && download.maxDpi) {
						dpi = [download.minDpi, download.maxDpi];
					} else if (download.minDpi) {
						dpi = [download.minDpi, -1];
					} else if (download.maxDpi) {
						dpi = [0, download.maxDpi];
					} //else dpi = [0, -1];

					if (dpi) {
						var includesDpi = false;
						for (var i3 = 0; i < dpis.length; i++) {
							if (dpis[i3][0] <= dpi[1]) {
								if (dpi[0] > dpis[i3][0])
									dpis[i3][0] = dpi[0];

								includesDpi = true;
								break;
							} else if (dpis[i3][1] >= dpi[0] || dpis[i3][1] == -1) {
								if (dpi[1] > dpis[i3][1] || dpi[1] == -1)
									dpis[i3][1] = dpi[1];

								includesDpi = true;
								break;
							}
						}

						if (!includesDpi)
							dpis.push(dpi);
					}
				}
			}

			var configurationsHtml = "";
			for (var i = 0; i < configurations.length; i++) {
				var text = null;
				if (configurations[i] == "phone")
					text = "Phone";
				else if (configurations[i] == "wear")
					text = "Android Wear";
				else if (configurations[i] == "auto")
					text = "Android Auto";
				else if (configurations[i] == "tv")
					text = "Android TV";

				configurationsHtml += "<option value=\"" + configurations[i] + "\">" + text + "</option>"
			}

			var sdksHtml = "";
			for (var i = 0; i < sdks.length; i++) {
				var text = null;
				if (sdks[i][1] >= 0)
					text = "Android " + sdkToVersion(sdks[i][0]) + " - " + sdkToVersion(sdks[i][1]);
				else text = "Android " + sdkToVersion(sdks[i][0]) + "+";

				sdksHtml += "<option value=\"" + sdks[i][0] + "/" + sdks[i][1] + "\">" + text + "</option>";
			}

			var architecturesHtml = "";
			for (var i = 0; i < architectures.length; i++) {
				architecturesHtml += "<option value=\"" + architectures[i] + "\">" + architectures[i] + "</option>"
			}

			var dpisHtml = dpis.length > 0 ? "" : "<option>nodpi</option>";
			for (var i = 0; i < dpis.length; i++) {
				var text = null;
				if (dpis[i][0] && dpis[i][1])
					text = dpis[i][0] + "dpi - " + dpis[i][1] + "dpi";
				else if (dpis[i][0])
					text = "&ge; " + dpis[i][0] + "dpi";
				else if (dpis[i][1])
					text = "&le; " + dpis[i][1] + "dpi";

				dpisHtml += "<option value=\"" + dpis[i][0] + "/" + dpis[i][1] + "\">" + text + "</option>";
			}

			element.appendChild(createElement("<div class=\"row grid\">"
				+ "<div><i class=\"material-icons\">devices_other</i><div class=\"dropdown\"><span>Configuration</span>"
				+ "<select id=\"configSelect\"" + (configurations.length > 1 ? "" : " class=\"disabled\"") + ">" + configurationsHtml + "</select></div></div>"
				+ "<div><i class=\"material-icons\">android</i><div class=\"dropdown\"><span>Android Version</span>"
				+ "<select id=\"sdkSelect\"" + (sdks.length > 1 ? "" : " class=\"disabled\"") + ">" + sdksHtml + "</select></div></div>"
				+ "<div><i class=\"material-icons\">memory</i><div class=\"dropdown\"><span>Architecture</span>"
				+ "<select id=\"archSelect\"" + (architectures.length > 1 ? "" : " class=\"disabled\"") + ">" + architecturesHtml + "</select></div></div>"
				+ "<div><i class=\"material-icons\">devices</i><div class=\"dropdown\"><span>Screen Density</span>"
				+ "<select id=\"dpiSelect\"" + (dpis.length > 1 ? "" : " class=\"disabled\"") + ">" + dpisHtml + "</select></div></div>"
				+ "</div>"));

			element.appendChild(createElement("<div id=\"releases\" class=\"row grid\"></div>"))

			if (args) {
				var configSelect = document.getElementById("configSelect");
				var sdkSelect = document.getElementById("sdkSelect");
				var archSelect = document.getElementById("archSelect");
				var dpiSelect = document.getElementById("dpiSelect");

				if (args.config) {
					configSelect.value = args.config;
				}

				if (args.sdk) {
					sdkSelect.value = args.sdk;
				}

				if (args.arch) {
					archSelect.value = args.arch;
				}

				if (args.dpi) {
					dpiSelect.value = args.dpi;
				}
			}

			var onSelect = function(shouldSkipUpdate) {
				var releasesElement = document.getElementById("releases");
				clearElement(releasesElement);

				var configSelect = document.getElementById("configSelect");
				var config = configSelect.value;

				var sdkSelect = document.getElementById("sdkSelect");
				var sdk = sdkSelect.value;
				var sdkArray = sdk.split("/");

				var archSelect = document.getElementById("archSelect");
				var arch = archSelect.value;

				var dpiSelect = document.getElementById("dpiSelect");
				var dpi = dpiSelect.value;
				var dpiArray = dpi.split("/");

				var items = [];
				for (var i = 0; i < app.releases.length; i++) {
					var release = app.releases[i];
					for (var i2 = 0; i2 < release.downloads.length; i2++) {
						var download = release.downloads[i2];

						if ((download.config == config || (config == "phone" && !download.config))
								&& ((download.min < sdkArray[1] || sdkArray[1] == -1) && (!download.max || download.max > sdkArray[0])) && (download.arch == arch || arch == "all")
								&& (((download.minDpi ? download.minDpi : 0) < dpiArray[1] || dpiArray[1] == -1) && (!download.maxDpi || download.maxDpi > dpiArray[0]))) {
							items.push({
								"release": release,
								"download": download
							});
						}
					}
				}

				if (shouldShorten && items.length > 4) {
					releasesElement.appendChild(createElement(nothingListMethod({}, items.slice(0, 4), downloadMethod)));
					releasesElement.appendChild(createElement("<a style=\"width: 100%\" onclick=\"setPage(\'page=releases&package=" + app.package + "&config=" + config + "&sdk=" + sdk + "&arch=" + arch + "&dpi=" + dpi + "\');\"><i class=\"material-icons\">open_in_new</i>MORE RELEASES</a>"));
				} else releasesElement.appendChild(createElement(nothingListMethod({}, items, downloadMethod)));

				if (args) {
					args.config = config;
					args.sdk = sdk;
					args.arch = arch;
					args.dpi = dpi;

					if (!(typeof shouldSkipUpdate == "boolean" && shouldSkipUpdate))
						window.history.replaceState({}, "", "?" + argumentsToString(args));
				}
			}

			document.getElementById("configSelect").addEventListener("change", onSelect);
			document.getElementById("sdkSelect").addEventListener("change", onSelect);
			document.getElementById("archSelect").addEventListener("change", onSelect);
			document.getElementById("dpiSelect").addEventListener("change", onSelect);
			onSelect(true);
		}

		setPage(getPage(), true);

		window.onpopstate = function() {
			setPage(getPage(), true);
			console.log("h");
		}

		window.addEventListener("load", function() {
			firebase.auth().onAuthStateChanged(function(user) {
				if (user) {
					signInElement.style.display = "none";
					profileElement.style.display = null;

					profileNameElement.innerHTML = user.displayName;
					profileEmailElement.innerHTML = user.email;
					profilePictureElement.src = user.photoURL;
				} else {
					profileElement.style.display = "none";
					signInElement.style.display = null;
				}
			}, function(error) {
				console.log(error);
			});
		});
	</script>
</body>
</html>
